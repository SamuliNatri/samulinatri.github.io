<!DOCTYPE html>
<html lang="en">

<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="description" content="How to draw a pixel using Windows API">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css?v=22">
    <title>Win32 - Drawing Pixels (C) |  Samuli Natri. Software Developer.</title>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-7348837-18"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-7348837-18');

    </script>
    

</head>

<body>
    <div class="main ">

            <p class="menu">
                <a class="menu-link " href="/">Home</a> &#x2219
                
                
                <a class="menu-link" target="_blank" href="http://www.youtube.com/c/SamuliNatri">YouTube</a> &#x2219
                <a class="menu-link" target="_blank" href="http://github.com/SamuliNatri">GitHub</a> &#x2219
                <a class="menu-link" target="_blank" href="https://twitter.com/SamuliNatri">Twitter</a>
            </p>

            

            

<div class="blog">

    

    <div class="blog-top">
       
        <h1 class="blog-top-title">Win32 - Drawing Pixels (C)</h1> 
        <span class="blog-top-separator"></span>
        <div class="blog-top-description">How to draw a pixel using Windows API</div>
        <div class="blog-top-date" itemprop="dateModified" content=" Jun 20, 2023">Updated Jun 20, 2023
        </div>

        
    </div>    

    <div class="blog-content">
        <pre data-lang="c" style="background-color:#2e3440;color:#d8dee9;" class="language-c "><code class="language-c" data-lang="c"><span style="color:#616e88;">// cl main.c
</span><span>
</span><span style="color:#81a1c1;">#define WIN32_LEAN_AND_MEAN
</span><span style="color:#5e81ac;">#include </span><span style="color:#a3be8c;">&lt;windows.h&gt;
</span><span style="color:#5e81ac;">#include </span><span style="color:#a3be8c;">&lt;stdint.h&gt;
</span><span>
</span><span style="color:#81a1c1;">#define </span><span style="font-weight:bold;color:#88c0d0;">Assert</span><span>(</span><span style="font-weight:bold;color:#d8dee9;">c</span><span>) </span><span style="color:#81a1c1;">do </span><span>{ </span><span style="color:#81a1c1;">if </span><span>(</span><span style="color:#81a1c1;">!</span><span>(c)) </span><span style="font-weight:bold;color:#88c0d0;">__debugbreak</span><span>()</span><span style="color:#eceff4;">; </span><span>} </span><span style="color:#81a1c1;">while </span><span>(</span><span style="color:#b48ead;">0</span><span>)
</span><span>
</span><span style="color:#5e81ac;">#pragma</span><span> comment (lib, &quot;user32.lib&quot;)
</span><span style="color:#5e81ac;">#pragma</span><span> comment (lib, &quot;gdi32.lib&quot;)
</span><span>
</span><span style="color:#81a1c1;">typedef </span><span style="color:#8fbcbb;">uint32_t </span><span style="color:#81a1c1;">u32</span><span style="color:#eceff4;">;
</span><span>
</span><span style="color:#81a1c1;">int</span><span> ClientWidth</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">int</span><span> ClientHeight</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">void *</span><span>Memory</span><span style="color:#eceff4;">;
</span><span>
</span><span style="color:#81a1c1;">void </span><span style="font-weight:bold;color:#88c0d0;">DrawPixel</span><span>(</span><span style="color:#81a1c1;">int </span><span style="font-weight:bold;color:#d8dee9;">X</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">int </span><span style="font-weight:bold;color:#d8dee9;">Y</span><span style="color:#eceff4;">,</span><span> u32 </span><span style="font-weight:bold;color:#d8dee9;">Color</span><span>) {
</span><span>    u32 </span><span style="color:#81a1c1;">*</span><span>Pixel </span><span style="color:#81a1c1;">= </span><span>(u32 </span><span style="color:#81a1c1;">*</span><span>)Memory</span><span style="color:#eceff4;">;
</span><span>    Pixel </span><span style="color:#81a1c1;">+=</span><span> Y </span><span style="color:#81a1c1;">*</span><span> ClientWidth </span><span style="color:#81a1c1;">+</span><span> X</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">*</span><span>Pixel </span><span style="color:#81a1c1;">=</span><span> Color</span><span style="color:#eceff4;">;
</span><span>}
</span><span>
</span><span style="color:#81a1c1;">void </span><span style="font-weight:bold;color:#88c0d0;">ClearScreen</span><span>(u32 </span><span style="font-weight:bold;color:#d8dee9;">Color</span><span>) {
</span><span>    u32 </span><span style="color:#81a1c1;">*</span><span>Pixel </span><span style="color:#81a1c1;">= </span><span>(u32 </span><span style="color:#81a1c1;">*</span><span>)Memory</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">for</span><span>(</span><span style="color:#81a1c1;">int</span><span> Index </span><span style="color:#81a1c1;">= </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">;</span><span> Index </span><span style="color:#81a1c1;">&lt;</span><span> ClientWidth </span><span style="color:#81a1c1;">*</span><span> ClientHeight</span><span style="color:#eceff4;">; </span><span style="color:#81a1c1;">++</span><span>Index) {
</span><span>        </span><span style="color:#81a1c1;">*</span><span>Pixel</span><span style="color:#81a1c1;">++ =</span><span> Color</span><span style="color:#eceff4;">;
</span><span>    }
</span><span>}
</span><span>
</span><span style="color:#8fbcbb;">LRESULT CALLBACK </span><span style="font-weight:bold;color:#88c0d0;">WindowProc</span><span>(</span><span style="color:#8fbcbb;">HWND </span><span style="font-weight:bold;color:#d8dee9;">Window</span><span style="color:#eceff4;">, </span><span style="color:#8fbcbb;">UINT </span><span style="font-weight:bold;color:#d8dee9;">Message</span><span style="color:#eceff4;">, </span><span style="color:#8fbcbb;">WPARAM </span><span style="font-weight:bold;color:#d8dee9;">WParam</span><span style="color:#eceff4;">, </span><span style="color:#8fbcbb;">LPARAM </span><span style="font-weight:bold;color:#d8dee9;">LParam</span><span>) {
</span><span>    </span><span style="color:#81a1c1;">switch</span><span>(Message) {
</span><span>        </span><span style="color:#81a1c1;">case</span><span> WM_DESTROY</span><span style="color:#eceff4;">: </span><span>{
</span><span>            </span><span style="font-weight:bold;color:#88c0d0;">PostQuitMessage</span><span>(</span><span style="color:#b48ead;">0</span><span>)</span><span style="color:#eceff4;">;
</span><span>        } </span><span style="color:#81a1c1;">break</span><span style="color:#eceff4;">;
</span><span>        </span><span style="color:#81a1c1;">case</span><span> WM_KEYDOWN</span><span style="color:#eceff4;">: </span><span>{
</span><span>            </span><span style="color:#81a1c1;">switch</span><span>(WParam) {
</span><span>                </span><span style="color:#81a1c1;">case </span><span style="color:#a3be8c;">&#39;O&#39;</span><span style="color:#eceff4;">: </span><span>{ 
</span><span>                    </span><span style="font-weight:bold;color:#88c0d0;">DestroyWindow</span><span>(Window)</span><span style="color:#eceff4;">; 
</span><span>                } </span><span style="color:#81a1c1;">break</span><span style="color:#eceff4;">;
</span><span>            }
</span><span>        } </span><span style="color:#81a1c1;">break</span><span style="color:#eceff4;">;
</span><span>        </span><span style="color:#81a1c1;">default</span><span style="color:#eceff4;">: </span><span>{
</span><span>            </span><span style="color:#81a1c1;">return </span><span style="font-weight:bold;color:#88c0d0;">DefWindowProcW</span><span>(Window</span><span style="color:#eceff4;">,</span><span> Message</span><span style="color:#eceff4;">,</span><span> WParam</span><span style="color:#eceff4;">,</span><span> LParam)</span><span style="color:#eceff4;">;
</span><span>        }
</span><span>    }
</span><span>    
</span><span>    </span><span style="color:#81a1c1;">return </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">;
</span><span>}
</span><span>
</span><span style="color:#81a1c1;">int </span><span style="color:#8fbcbb;">WINAPI </span><span style="font-weight:bold;color:#88c0d0;">WinMain</span><span>(</span><span style="color:#8fbcbb;">HINSTANCE </span><span style="font-weight:bold;color:#d8dee9;">Instance</span><span style="color:#eceff4;">, </span><span style="color:#8fbcbb;">HINSTANCE </span><span style="font-weight:bold;color:#d8dee9;">PrevInstance</span><span style="color:#eceff4;">, </span><span style="color:#8fbcbb;">LPSTR </span><span style="font-weight:bold;color:#d8dee9;">Cmd</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">int </span><span style="font-weight:bold;color:#d8dee9;">CmdShow</span><span>) {
</span><span>    
</span><span>    </span><span style="color:#616e88;">// Create a window.
</span><span>    
</span><span>    WNDCLASSW WindowClass </span><span style="color:#81a1c1;">= </span><span>{
</span><span>        </span><span style="color:#81a1c1;">.</span><span>lpszClassName </span><span style="color:#81a1c1;">= L</span><span style="color:#a3be8c;">&quot;MyWindowClass&quot;</span><span style="color:#eceff4;">,
</span><span>        </span><span style="color:#81a1c1;">.</span><span>lpfnWndProc </span><span style="color:#81a1c1;">=</span><span> WindowProc</span><span style="color:#eceff4;">,
</span><span>        </span><span style="color:#81a1c1;">.</span><span>hInstance </span><span style="color:#81a1c1;">=</span><span> Instance</span><span style="color:#eceff4;">,
</span><span>        </span><span style="color:#81a1c1;">.</span><span>hCursor </span><span style="color:#81a1c1;">= </span><span style="font-weight:bold;color:#88c0d0;">LoadCursor</span><span>(</span><span style="color:#81a1c1;">NULL</span><span style="color:#eceff4;">,</span><span> IDC_CROSS)</span><span style="color:#eceff4;">,
</span><span>    }</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#8fbcbb;">ATOM</span><span> Atom </span><span style="color:#81a1c1;">= </span><span style="font-weight:bold;color:#88c0d0;">RegisterClassW</span><span>(</span><span style="color:#81a1c1;">&amp;</span><span>WindowClass)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="font-weight:bold;color:#88c0d0;">Assert</span><span>(Atom </span><span style="color:#81a1c1;">&amp;&amp; </span><span style="color:#a3be8c;">&quot;Failed to register a window&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>    
</span><span>    </span><span style="color:#8fbcbb;">HWND</span><span> Window </span><span style="color:#81a1c1;">= </span><span style="font-weight:bold;color:#88c0d0;">CreateWindowW</span><span>(WindowClass</span><span style="color:#81a1c1;">.</span><span>lpszClassName</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">L</span><span style="color:#a3be8c;">&quot;Drawing Pixels&quot;</span><span style="color:#eceff4;">,</span><span> WS_OVERLAPPEDWINDOW</span><span style="color:#eceff4;">,</span><span> CW_USEDEFAULT</span><span style="color:#eceff4;">,</span><span> CW_USEDEFAULT</span><span style="color:#eceff4;">,</span><span> CW_USEDEFAULT</span><span style="color:#eceff4;">,</span><span> CW_USEDEFAULT</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">NULL</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">NULL</span><span style="color:#eceff4;">,</span><span> Instance</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">NULL</span><span>)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="font-weight:bold;color:#88c0d0;">Assert</span><span>(Window </span><span style="color:#81a1c1;">&amp;&amp; </span><span style="color:#a3be8c;">&quot;Failed to create a window&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>    
</span><span>    </span><span style="font-weight:bold;color:#88c0d0;">ShowWindow</span><span>(Window</span><span style="color:#eceff4;">,</span><span> CmdShow)</span><span style="color:#eceff4;">;
</span><span>    
</span><span>    </span><span style="color:#616e88;">// Allocate memory.
</span><span>    
</span><span>    RECT Rect</span><span style="color:#eceff4;">;
</span><span>    </span><span style="font-weight:bold;color:#88c0d0;">GetClientRect</span><span>(Window</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">&amp;</span><span>Rect)</span><span style="color:#eceff4;">;
</span><span>    ClientWidth </span><span style="color:#81a1c1;">=</span><span> Rect</span><span style="color:#81a1c1;">.</span><span>right </span><span style="color:#81a1c1;">-</span><span> Rect</span><span style="color:#81a1c1;">.</span><span>left</span><span style="color:#eceff4;">;
</span><span>    ClientHeight </span><span style="color:#81a1c1;">=</span><span> Rect</span><span style="color:#81a1c1;">.</span><span>bottom </span><span style="color:#81a1c1;">-</span><span> Rect</span><span style="color:#81a1c1;">.</span><span>top</span><span style="color:#eceff4;">;
</span><span>    
</span><span>    Memory </span><span style="color:#81a1c1;">= </span><span style="font-weight:bold;color:#88c0d0;">VirtualAlloc</span><span>(</span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">,</span><span> ClientWidth </span><span style="color:#81a1c1;">*</span><span> ClientHeight </span><span style="color:#81a1c1;">* </span><span style="color:#b48ead;">4</span><span style="color:#eceff4;">,</span><span> MEM_RESERVE</span><span style="color:#81a1c1;">|</span><span>MEM_COMMIT</span><span style="color:#eceff4;">,</span><span> PAGE_READWRITE)</span><span style="color:#eceff4;">;
</span><span>    
</span><span>    </span><span style="color:#616e88;">// Create BITMAPINFO struct for StretchDIBits().
</span><span>    
</span><span>    BITMAPINFO BitmapInfo</span><span style="color:#eceff4;">;
</span><span>    BitmapInfo</span><span style="color:#81a1c1;">.</span><span>bmiHeader</span><span style="color:#81a1c1;">.</span><span>biSize </span><span style="color:#81a1c1;">= </span><span style="font-style:italic;color:#88c0d0;">sizeof</span><span>(BitmapInfo</span><span style="color:#81a1c1;">.</span><span>bmiHeader)</span><span style="color:#eceff4;">;
</span><span>    BitmapInfo</span><span style="color:#81a1c1;">.</span><span>bmiHeader</span><span style="color:#81a1c1;">.</span><span>biWidth </span><span style="color:#81a1c1;">=</span><span> ClientWidth</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#616e88;">// Negative biHeight makes top left as the coordinate system origin. Otherwise it&#39;s bottom left.
</span><span>    BitmapInfo</span><span style="color:#81a1c1;">.</span><span>bmiHeader</span><span style="color:#81a1c1;">.</span><span>biHeight </span><span style="color:#81a1c1;">= -</span><span>ClientHeight</span><span style="color:#eceff4;">;
</span><span>    BitmapInfo</span><span style="color:#81a1c1;">.</span><span>bmiHeader</span><span style="color:#81a1c1;">.</span><span>biPlanes </span><span style="color:#81a1c1;">= </span><span style="color:#b48ead;">1</span><span style="color:#eceff4;">;
</span><span>    BitmapInfo</span><span style="color:#81a1c1;">.</span><span>bmiHeader</span><span style="color:#81a1c1;">.</span><span>biBitCount </span><span style="color:#81a1c1;">= </span><span style="color:#b48ead;">32</span><span style="color:#eceff4;">;
</span><span>    BitmapInfo</span><span style="color:#81a1c1;">.</span><span>bmiHeader</span><span style="color:#81a1c1;">.</span><span>biCompression </span><span style="color:#81a1c1;">=</span><span> BI_RGB</span><span style="color:#eceff4;">;
</span><span>    
</span><span>    </span><span style="color:#8fbcbb;">HDC</span><span> DeviceContext </span><span style="color:#81a1c1;">= </span><span style="font-weight:bold;color:#88c0d0;">GetDC</span><span>(Window)</span><span style="color:#eceff4;">;
</span><span>    
</span><span>    </span><span style="color:#81a1c1;">for</span><span>(</span><span style="color:#eceff4;">;;</span><span>) {
</span><span>        MSG Message</span><span style="color:#eceff4;">;
</span><span>        </span><span style="color:#81a1c1;">if</span><span>(</span><span style="font-weight:bold;color:#88c0d0;">PeekMessage</span><span>(</span><span style="color:#81a1c1;">&amp;</span><span>Message</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">NULL</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">,</span><span> PM_REMOVE)) {
</span><span>            </span><span style="color:#81a1c1;">if</span><span>(Message</span><span style="color:#81a1c1;">.</span><span>message </span><span style="color:#81a1c1;">==</span><span> WM_QUIT) </span><span style="color:#81a1c1;">break</span><span style="color:#eceff4;">;
</span><span>            </span><span style="font-weight:bold;color:#88c0d0;">TranslateMessage</span><span>(</span><span style="color:#81a1c1;">&amp;</span><span>Message)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="font-weight:bold;color:#88c0d0;">DispatchMessage</span><span>(</span><span style="color:#81a1c1;">&amp;</span><span>Message)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">continue</span><span style="color:#eceff4;">;
</span><span>        }    
</span><span>        
</span><span>        </span><span style="color:#616e88;">// Clear screen.
</span><span>        
</span><span>        </span><span style="font-weight:bold;color:#88c0d0;">ClearScreen</span><span>(</span><span style="color:#b48ead;">0x333333</span><span>)</span><span style="color:#eceff4;">;
</span><span>        
</span><span>        </span><span style="color:#616e88;">// Draw white pixel at 100, 100 (from top left).
</span><span>        
</span><span>        </span><span style="font-weight:bold;color:#88c0d0;">DrawPixel</span><span>(</span><span style="color:#b48ead;">100</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">100</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">0xffffff</span><span>)</span><span style="color:#eceff4;">;
</span><span>        
</span><span>        </span><span style="color:#616e88;">// Display image.
</span><span>        
</span><span>        </span><span style="font-weight:bold;color:#88c0d0;">StretchDIBits</span><span>(DeviceContext</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">,</span><span> ClientWidth</span><span style="color:#eceff4;">,</span><span> ClientHeight</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">,</span><span> ClientWidth</span><span style="color:#eceff4;">,</span><span> ClientHeight</span><span style="color:#eceff4;">,</span><span> Memory</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">&amp;</span><span>BitmapInfo</span><span style="color:#eceff4;">,</span><span> DIB_RGB_COLORS</span><span style="color:#eceff4;">,</span><span> SRCCOPY)</span><span style="color:#eceff4;">;
</span><span>    }
</span><span>    
</span><span>    </span><span style="color:#81a1c1;">return </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">;
</span><span>}
</span></code></pre>
<div class="blog-sources">
Inspired by: <a target="_blank" href="https://handmadehero.org/">https://handmadehero.org/</a>
<p>Check this if you want to use Direct3D 11 to display software drawn pixels: <a target="_blank" href="https://gist.github.com/mmozeiko/6f36f2b82204b70a9b7fe6c05ccd868f">https://gist.github.com/mmozeiko/6f36f2b82204b70a9b7fe6c05ccd868f</a></p>
</div>
        
    </div>

    <script>
        const copyButtonLabel = "Copy";
        let blocks = document.querySelectorAll("pre");
        blocks.forEach((block) => {
            if (navigator.clipboard) {
                let button = document.createElement("button");
                button.innerText = copyButtonLabel;
                button.addEventListener("click", copyCode);
                block.appendChild(button);
            }
        });
        async function copyCode(event) {
            const button = event.srcElement;
            const pre = button.parentElement;
            let code = pre.querySelector("code");
            let text = code.innerText;
            await navigator.clipboard.writeText(text);
            button.innerText = "Copied";
            setTimeout(() => {
                button.innerText = copyButtonLabel;
            }, 500)
        }
    </script>

    


            
            <div class="footer">&copy 2023 Samuli Natri. All rights reserved.</div>
            

            
            <script type="text/javascript"
                src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5bd9de747b7c9f30"></script>
            

            <script type="text/javascript">
                let section = document.URL.split('/')[3];
                if (section) {
                    document.getElementById("menu-link-" + section).classList.add("menu-link-active");
                }
            </script>

        <div class="clear"></div>
    </div> <!-- main -->

</body>

</html>